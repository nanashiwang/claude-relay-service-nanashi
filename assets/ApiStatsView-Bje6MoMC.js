import{aP as je,r as M,c as L,aX as ue,x as l,y as r,z as e,O as w,L as I,P as a,u as t,C as U,K as ge,aq as ke,aa as $e,f as Ce,Y as Re,Q as G,ac as Z,B as me,R as se,o as ve,V as Ke,I as pe,aV as Se,a5 as Oe,q as qe,aW as Ue,J as Te,av as Ee}from"./vue-vendor-R8HMg95E.js";import{_ as ne,A as Ae,a as Ne}from"./index-Cmg7hXd1.js";import{L as Fe}from"./LogoTitle-CdkvgqM6.js";import{T as Ve}from"./ThemeToggle-DuESlhtz.js";import{b as We}from"./vendor-Dr8jvgFu.js";import{_ as Be}from"./WindowCountdown-DF7xS2EZ.js";import ze from"./TutorialView-hNwZvEfW.js";import"./element-plus-BUfCkBQO.js";class Je{constructor(){this.baseURL=window.location.origin,this.isDev=!1}async request(h,s={}){try{this.isDev&&h.startsWith("/admin")&&(h="/webapi"+h);const v=await fetch(`${this.baseURL}${h}`,{headers:{"Content-Type":"application/json",...s.headers},...s}),c=await v.json();if(!v.ok){const x=new Error(c.message||`请求失败: ${v.status}`);throw x.data=c,x.status=v.status,x}return c}catch(v){throw console.error("API Stats request error:",v),v}}async getKeyId(h){return this.request("/apiStats/api/get-key-id",{method:"POST",body:JSON.stringify({apiKey:h})})}async getUserStats(h){return this.request("/apiStats/api/user-stats",{method:"POST",body:JSON.stringify({apiId:h})})}async getUserModelStats(h,s="daily"){return this.request("/apiStats/api/user-model-stats",{method:"POST",body:JSON.stringify({apiId:h,period:s})})}async getOemSettings(){try{return await this.request("/admin/oem-settings")}catch(h){return console.error("Failed to load OEM settings:",h),{success:!0,data:{siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}}}async getBatchStats(h){return this.request("/apiStats/api/batch-stats",{method:"POST",body:JSON.stringify({apiIds:h})})}async getBatchModelStats(h,s="daily"){return this.request("/apiStats/api/batch-model-stats",{method:"POST",body:JSON.stringify({apiIds:h,period:s})})}async mergeKeys(h){return this.request("/apiStats/api/merge-keys",{method:"POST",body:JSON.stringify(h)})}}const ae=new Je,ce=je("apistats",()=>{const z=M(""),h=M(null),s=M(!1),v=M(!1),c=M(!0),x=M(""),y=M("daily"),$=M(null),g=M([]),O=M(null),p=M(null),A=M({siteName:"",siteIcon:"",siteIconData:""}),F=M(!1),C=M([]),_=M([]),u=M(null),o=M([]),j=M([]),f=L(()=>{const m={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};return F.value&&u.value?y.value==="daily"?u.value.dailyUsage||m:u.value.monthlyUsage||m:y.value==="daily"?O.value||m:p.value||m}),S=L(()=>{if(!$.value||!f.value)return{tokenUsage:0,costUsage:0,requestUsage:0};const m=f.value,T=$.value.limits;return{tokenUsage:T.tokenLimit>0?Math.min(m.allTokens/T.tokenLimit*100,100):0,costUsage:T.dailyCostLimit>0?Math.min(m.cost/T.dailyCostLimit*100,100):0,requestUsage:T.rateLimitRequests>0?Math.min(m.requests/T.rateLimitRequests*100,100):0}});async function E(){if(F.value)return ee();const m=z.value.trim();if(!m){x.value="请输入 API Key";return}if(m.length<10||m.length>512){x.value="API Key 格式无效：长度应在 10-512 个字符之间";return}s.value=!0,x.value="",$.value=null,g.value=[],h.value=null;try{const T=await ae.getKeyId(m);if(T.success){h.value=T.data.id;const q=await ae.getUserStats(h.value);if(q.success)$.value=q.data,await R(),x.value="",re();else throw new Error(q.message||"查询失败")}else throw new Error(T.message||"获取 API Key ID 失败")}catch(T){console.error("Query stats error:",T),x.value=T.message||"查询统计数据失败，请检查您的 API Key 是否正确",$.value=null,g.value=[],h.value=null}finally{s.value=!1}}async function R(){h.value&&(await Promise.all([V("daily"),V("monthly")]),await Q(y.value))}async function V(m){try{const T=await ae.getUserModelStats(h.value,m);if(T.success){const q=T.data||[],J={requests:0,inputTokens:0,outputTokens:0,cacheCreateTokens:0,cacheReadTokens:0,allTokens:0,cost:0,formattedCost:"$0.000000"};q.forEach(N=>{var H;J.requests+=N.requests||0,J.inputTokens+=N.inputTokens||0,J.outputTokens+=N.outputTokens||0,J.cacheCreateTokens+=N.cacheCreateTokens||0,J.cacheReadTokens+=N.cacheReadTokens||0,J.allTokens+=N.allTokens||0,J.cost+=((H=N.costs)==null?void 0:H.total)||0}),J.formattedCost=X(J.cost),m==="daily"?O.value=J:p.value=J}else console.warn(`Failed to load ${m} stats:`,T.message)}catch(T){console.error(`Load ${m} stats error:`,T)}}async function Q(m="daily"){if(h.value){v.value=!0;try{const T=await ae.getUserModelStats(h.value,m);if(T.success)g.value=T.data||[];else throw new Error(T.message||"加载模型统计失败")}catch(T){console.error("Load model stats error:",T),g.value=[]}finally{v.value=!1}}}async function ie(m){if(!(y.value===m||v.value)){if(y.value=m,F.value&&_.value.length>0){await de(m);return}(m==="daily"&&!O.value||m==="monthly"&&!p.value)&&await V(m),await Q(m)}}async function B(){var m,T;if(h.value){s.value=!0,x.value="",$.value=null,g.value=[];try{const q=await ae.getUserStats(h.value);if(q.success)$.value=q.data,console.log("API Stats - Full response:",q.data),console.log("API Stats - limits data:",q.data.limits),console.log("API Stats - weeklyOpusCostLimit:",(m=q.data.limits)==null?void 0:m.weeklyOpusCostLimit),console.log("API Stats - weeklyOpusCost:",(T=q.data.limits)==null?void 0:T.weeklyOpusCost),await R(),x.value="";else throw new Error(q.message||"查询失败")}catch(q){console.error("Load stats with apiId error:",q),x.value=q.message||"查询统计数据失败",$.value=null,g.value=[]}finally{s.value=!1}}}async function K(){c.value=!0;try{const m=await ae.getOemSettings();m&&m.success&&m.data&&(A.value={...A.value,...m.data})}catch(m){console.error("Error loading OEM settings:",m),A.value={siteName:"Claude Relay Service",siteIcon:"",siteIconData:""}}finally{c.value=!1}}function X(m){return typeof m!="number"||m===0?"$0.000000":m>=1?"$"+m.toFixed(2):m>=.01?"$"+m.toFixed(4):"$"+m.toFixed(6)}function re(){if(h.value){const m=new URL(window.location);m.searchParams.set("apiId",h.value),window.history.pushState({},"",m)}}async function ee(){const m=n();if(m.length===0){x.value="请输入至少一个有效的 API Key";return}s.value=!0,x.value="",u.value=null,o.value=[],j.value=[],g.value=[],C.value=m,_.value=[];try{const T=await Promise.allSettled(m.map(H=>ae.getKeyId(H))),q=[],J=[];if(T.forEach((H,oe)=>{H.status==="fulfilled"&&H.value.success?(q.push(H.value.data.id),J.push(m[oe])):j.value.push(m[oe])}),q.length===0)throw new Error("所有 API Key 都无效");_.value=q,C.value=J;const N=await ae.getBatchStats(q);if(N.success)u.value=N.data.aggregated,o.value=N.data.individual,$.value=N.data.aggregated,O.value=N.data.aggregated.dailyUsage||null,p.value=N.data.aggregated.monthlyUsage||null,await de(y.value),i();else throw new Error(N.message||"批量查询失败")}catch(T){console.error("Batch query error:",T),x.value=T.message||"批量查询统计数据失败",u.value=null,o.value=[]}finally{s.value=!1}}async function de(m="daily"){if(_.value.length!==0){v.value=!0;try{const T=await ae.getBatchModelStats(_.value,m);if(T.success)g.value=T.data||[];else throw new Error(T.message||"加载批量模型统计失败")}catch(T){console.error("Load batch model stats error:",T),g.value=[]}finally{v.value=!1}}}function n(){if(!z.value)return[];const m=z.value.split(/[,\n]+/).map(q=>q.trim()).filter(q=>q.length>=10&&q.length<=512);return[...new Set(m)].slice(0,30)}function i(){if(_.value.length>0){const m=new URL(window.location);m.searchParams.set("apiIds",_.value.join(",")),m.searchParams.set("batch","true"),window.history.pushState({},"",m)}}function b(){z.value=""}function D(){$.value=null,g.value=[],O.value=null,p.value=null,x.value="",y.value="daily",h.value=null,C.value=[],_.value=[],u.value=null,o.value=[],j.value=[]}function W(){z.value="",F.value=!1,D()}return{apiKey:z,apiId:h,loading:s,modelStatsLoading:v,oemLoading:c,error:x,statsPeriod:y,statsData:$,modelStats:g,dailyStats:O,monthlyStats:p,oemSettings:A,multiKeyMode:F,apiKeys:C,apiIds:_,aggregatedStats:u,individualStats:o,invalidKeys:j,currentPeriodData:f,usagePercentages:S,queryStats:E,queryBatchStats:ee,loadAllPeriodStats:R,loadPeriodStats:V,loadModelStats:Q,loadBatchModelStats:de,switchPeriod:ie,loadStatsWithApiId:B,loadOemSettings:K,clearData:D,clearInput:b,reset:W}}),Ge={class:"api-input-wide-card mb-8 rounded-3xl p-6 shadow-xl"},He={class:"mx-auto max-w-4xl"},Ye={class:"control-bar mb-4 flex flex-wrap items-center justify-between gap-3"},Qe={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Xe={class:"button-group flex items-center gap-2"},Ze={class:"mode-switch-group flex items-center rounded-lg bg-gray-100 p-1 dark:bg-gray-800"},et={key:0,class:"ml-1 rounded-full bg-white/20 px-1.5 py-0.5 text-xs font-semibold"},tt={class:"api-input-grid grid grid-cols-1 gap-4 lg:grid-cols-4"},st={class:"lg:col-span-3"},at=["disabled"],rt={key:1,class:"relative"},lt=["disabled"],it={class:"lg:col-span-1"},ot=["disabled"],nt={key:0,class:"fas fa-spinner loading-spinner"},dt={key:1,class:"fas fa-search"},ut={class:"security-notice mt-4"},ct={key:0,class:"mt-2 rounded-lg bg-blue-50 p-3 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-400"},mt={__name:"ApiKeyInput",setup(z){const h=ce(),{apiKey:s,loading:v,multiKeyMode:c}=ue(h),{queryStats:x,clearInput:y}=h,$=L(()=>{if(!c.value||!s.value)return[];const O=s.value.split(/[,\n]+/).map(A=>A.trim()).filter(A=>A.length>0);return[...new Set(O)].slice(0,30)}),g=L(()=>c.value?$.value.length>0:s.value&&s.value.trim().length>0);return(O,p)=>(r(),l("div",Ge,[p[15]||(p[15]=e("div",{class:"wide-card-title mb-6"},[e("h2",{class:"mb-2 text-2xl font-bold text-gray-900 dark:text-gray-200"},[e("i",{class:"fas fa-chart-line mr-3"}),w(" 使用统计查询 ")]),e("p",{class:"text-base text-gray-600 dark:text-gray-400"},"查询您的 API Key 使用情况和统计数据")],-1)),e("div",He,[e("div",Ye,[e("label",Qe,[p[8]||(p[8]=e("i",{class:"fas fa-key mr-2"},null,-1)),w(" "+a(t(c)?"输入您的 API Keys（每行一个或用逗号分隔）":"输入您的 API Key"),1)]),e("div",Xe,[e("div",Ze,[e("button",{class:U(["mode-switch-btn",{active:!t(c)}]),title:"单一模式",onClick:p[0]||(p[0]=A=>c.value=!1)},p[9]||(p[9]=[e("i",{class:"fas fa-key"},null,-1),e("span",{class:"ml-2 hidden sm:inline"},"单一",-1)]),2),e("button",{class:U(["mode-switch-btn",{active:t(c)}]),title:"聚合模式",onClick:p[1]||(p[1]=A=>c.value=!0)},[p[10]||(p[10]=e("i",{class:"fas fa-layer-group"},null,-1)),p[11]||(p[11]=e("span",{class:"ml-2 hidden sm:inline"},"聚合",-1)),t(c)&&$.value.length>0?(r(),l("span",et,a($.value.length),1)):I("",!0)],2)])])]),e("div",tt,[e("div",st,[t(c)?(r(),l("div",rt,[ge(e("textarea",{"onUpdate:modelValue":p[4]||(p[4]=A=>Ce(s)?s.value=A:null),class:"wide-card-input w-full resize-y",disabled:t(v),placeholder:`请输入您的 API Keys，支持以下格式：
cr_xxx
cr_yyy
或
cr_xxx, cr_yyy`,rows:"4",onKeyup:p[5]||(p[5]=$e(Re((...A)=>t(x)&&t(x)(...A),["ctrl"]),["enter"]))},null,40,lt),[[ke,t(s)]]),t(s)&&!t(v)?(r(),l("button",{key:0,class:"absolute right-2 top-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",title:"清空输入",onClick:p[6]||(p[6]=(...A)=>t(y)&&t(y)(...A))},p[12]||(p[12]=[e("i",{class:"fas fa-times-circle"},null,-1)]))):I("",!0)])):ge((r(),l("input",{key:0,"onUpdate:modelValue":p[2]||(p[2]=A=>Ce(s)?s.value=A:null),class:"wide-card-input w-full",disabled:t(v),placeholder:"请输入您的 API Key (cr_...)",type:"password",onKeyup:p[3]||(p[3]=$e((...A)=>t(x)&&t(x)(...A),["enter"]))},null,40,at)),[[ke,t(s)]])]),e("div",it,[e("button",{class:"btn btn-primary btn-query flex h-full w-full items-center justify-center gap-2",disabled:t(v)||!g.value,onClick:p[7]||(p[7]=(...A)=>t(x)&&t(x)(...A))},[t(v)?(r(),l("i",nt)):(r(),l("i",dt)),w(" "+a(t(v)?"查询中...":"查询统计"),1)],8,ot)])]),e("div",ut,[p[13]||(p[13]=e("i",{class:"fas fa-shield-alt mr-2"},null,-1)),w(" "+a(t(c)?"您的 API Keys 仅用于查询统计数据，不会被存储。聚合模式下部分个体化信息将不显示。":"您的 API Key 仅用于查询自己的统计数据，不会被存储或用于其他用途"),1)]),t(c)?(r(),l("div",ct,p[14]||(p[14]=[e("i",{class:"fas fa-lightbulb mr-2"},null,-1),e("span",null,"提示：最多支持同时查询 30 个 API Keys。使用 Ctrl+Enter 快速查询。",-1)]))):I("",!0)])]))}},gt=ne(mt,[["__scopeId","data-v-11e74200"]]),ft={class:"space-y-6 md:space-y-8"},xt={class:"grid grid-cols-1 items-stretch gap-4 md:gap-6 xl:grid-cols-[minmax(0,1.5fr)_minmax(0,1fr)]"},yt={class:"card-section"},pt={class:"section-header"},vt={class:"header-title"},bt={key:0,class:"info-grid"},kt={class:"info-item"},ht={class:"info-value"},_t={class:"info-item"},wt={class:"info-value text-green-600 dark:text-emerald-400"},$t={key:0,class:"info-item"},Ct={class:"info-value text-red-500 dark:text-red-400"},St={class:"info-item"},Tt={class:"info-value"},At={class:"info-item"},Kt={class:"info-value"},Lt={class:"info-item"},Pt={class:"info-value text-indigo-600 dark:text-indigo-300"},Mt={key:1,class:"info-item xl:col-span-2"},It={class:"space-y-2"},Dt={class:"truncate"},jt={class:"font-semibold"},Rt={key:1,class:"info-grid"},Ot={class:"info-item"},qt={class:"info-value break-all"},Ut={class:"info-item"},Et={class:"info-item"},Nt={class:"info-value"},Ft={class:"info-item"},Vt={class:"info-value break-all"},Wt={class:"info-item xl:col-span-2"},Bt={class:"info-value"},zt={class:"ml-2 text-xs text-gray-500 dark:text-gray-400"},Jt={key:0,class:"text-red-500 dark:text-red-400"},Gt={key:1,class:"text-orange-500 dark:text-orange-400"},Ht={key:2},Yt={key:2,class:"text-gray-400 dark:text-gray-500"},Qt={class:"card-section"},Xt={class:"section-header"},Zt={class:"header-tag"},es={class:"metric-grid"},ts={class:"metric-card"},ss={class:"metric-value text-green-600 dark:text-emerald-300"},as={class:"metric-label"},rs={class:"metric-card"},ls={class:"metric-value text-blue-600 dark:text-sky-300"},is={class:"metric-label"},os={class:"metric-card"},ns={class:"metric-value text-purple-600 dark:text-violet-300"},ds={class:"metric-label"},us={class:"metric-card"},cs={class:"metric-value text-amber-500 dark:text-amber-300"},ms={class:"metric-label"},gs={key:0,class:"card-section"},fs={class:"flex items-center justify-between gap-3"},xs={class:"flex items-center gap-3"},ys={class:"account-name"},ps={class:"account-sub"},vs={key:0,class:"mt-3 space-y-2"},bs={class:"progress-row"},ks={class:"progress-track"},hs={class:"progress-value"},_s={class:"flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},ws={key:0,class:"font-medium text-indigo-600 dark:text-indigo-400"},$s={key:1,class:"mt-3"},Cs={key:0,class:"space-y-2"},Ss={class:"quota-header"},Ts={class:"quota-percent"},As={class:"progress-track"},Ks={class:"quota-foot"},Ls={key:1,class:"rounded-xl bg-slate-100 px-3 py-2 text-xs text-slate-500 dark:bg-slate-800 dark:text-slate-300"},Ps={__name:"StatsOverview",setup(z){const h=ce(),{statsData:s,statsPeriod:v,currentPeriodData:c,multiKeyMode:x,aggregatedStats:y,individualStats:$,invalidKeys:g}=ue(h),O=L(()=>!$.value||$.value.length===0?[]:[...$.value].sort((n,i)=>{var b,D;return(((b=i.usage)==null?void 0:b.allTokens)||0)-(((D=n.usage)==null?void 0:D.allTokens)||0)}).slice(0,3)),p=n=>{var b;return!y.value||!y.value.usage.allTokens?0:((((b=n.usage)==null?void 0:b.allTokens)||0)/y.value.usage.allTokens*100).toFixed(1)},A=n=>{if(!n)return"无";try{return We(n).format("YYYY年MM月DD日 HH:mm")}catch{return"格式错误"}},F=n=>n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",C=n=>n?new Date(n)<new Date:!1,_=n=>{if(!n)return!1;const D=(new Date(n)-new Date)/(1e3*60*60*24);return D>0&&D<=7},u=n=>(typeof n!="number"&&(n=parseInt(n)||0),n===0?"0":n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":n.toLocaleString()),o=n=>({claude:"Claude",gemini:"Gemini",all:"全部模型"})[n]||n||"未知",j=L(()=>{var b,D;const n=(D=(b=s.value)==null?void 0:b.accounts)==null?void 0:D.details;if(!n)return[];const i=[];return n.claude&&n.claude.accountType==="dedicated"&&i.push({key:"claude",...n.claude}),n.openai&&n.openai.accountType==="dedicated"&&i.push({key:"openai",...n.openai}),i}),f=L(()=>{const n=j.value.length;return n<=1?"md:grid-cols-1 lg:grid-cols-1":n===2?"md:grid-cols-2":"md:grid-cols-2 xl:grid-cols-3"}),S=n=>n?n.platform==="openai"?"OpenAI 专属账号":"Claude 专属账号":"专属账号",E=n=>{if(!n||n<=0)return"";const i=Math.floor(n),b=Math.floor(i/1440),D=Math.floor(i%1440/60),W=i%60;return b>0?D>0?`${b}天${D}小时`:`${b}天`:D>0?W>0?`${D}小时${W}分钟`:`${D}小时`:`${W}分钟`},R=n=>{if(!n)return{text:"状态未知",class:"text-gray-400"};if(n.isRateLimited){const i=E(n.minutesRemaining);return{text:`限流中${i?` · 剩余约 ${i}`:""}`,class:"text-red-500 dark:text-red-400"}}return{text:"未限流",class:"text-green-600 dark:text-emerald-400"}},V=(n,i)=>{if(!n||!i)return"暂无时间窗口信息";const b=new Date(n),D=new Date(i),W=m=>`${`${m.getHours()}`.padStart(2,"0")}:${`${m.getMinutes()}`.padStart(2,"0")}`;return`${W(b)} - ${W(D)}`},Q=n=>{if(!n||n<=0)return"";const i=Math.floor(n/60),b=n%60;return i>0?`${i}小时${b}分钟`:`${b}分钟`},ie=(n,i)=>{var D;if(!n)return"bg-gradient-to-r from-blue-500 to-indigo-500";if((D=i==null?void 0:i.rateLimitStatus)!=null&&D.isRateLimited)return"bg-gradient-to-r from-red-500 to-red-600";const b=String(n).toLowerCase();return b==="rejected"?"bg-gradient-to-r from-red-500 to-red-600":b==="allowed_warning"?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-blue-500 to-indigo-500"},B=n=>{if(!n)return null;const i=typeof n.usedPercent=="number"&&!Number.isNaN(n.usedPercent)?n.usedPercent:null,b=typeof n.resetAfterSeconds=="number"&&!Number.isNaN(n.resetAfterSeconds)?n.resetAfterSeconds:null,D=typeof n.remainingSeconds=="number"?n.remainingSeconds:null,W=n.resetAt?Date.parse(n.resetAt):null;return b!==null&&(D!==null&&D<=0||W!==null&&!Number.isNaN(W)&&Date.now()>=W)?0:i===null?null:Math.max(0,Math.min(100,i))},K=n=>{const i=B(n);return i===null?"bg-gradient-to-r from-gray-300 to-gray-400":i>=90?"bg-gradient-to-r from-red-500 to-red-600":i>=75?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-emerald-500 to-teal-500"},X=n=>{const i=B(n);return i===null?"0%":`${i}%`},re=n=>{const i=B(n);return i===null?"--":`${i.toFixed(1)}%`},ee=n=>{if(!n)return"--";let i=n.remainingSeconds;if(i==null&&(i=n.resetAfterSeconds),i==null||Number.isNaN(Number(i)))return"--";i=Math.max(0,Math.floor(Number(i)));const b=Math.floor(i/86400),D=Math.floor(i%86400/3600),W=Math.floor(i%3600/60),m=i%60;return b>0?D>0?`${b}天${D}小时`:`${b}天`:D>0?W>0?`${D}小时${W}分钟`:`${D}小时`:W>0?`${W}分钟`:`${m}秒`},de=n=>n==="secondary"?"周限":"5h";return(n,i)=>(r(),l("div",ft,[e("div",xt,[e("div",yt,[e("header",pt,[e("i",{class:U(["header-icon",t(x)?"fas fa-layer-group text-purple-500":"fas fa-info-circle text-blue-500"])},null,2),e("h3",vt,a(t(x)?"批量查询概要":"API Key 信息"),1)]),t(x)&&t(y)?(r(),l("div",bt,[e("div",kt,[i[0]||(i[0]=e("p",{class:"info-label"},"查询 Keys 数",-1)),e("p",ht,a(t(y).totalKeys)+" 个",1)]),e("div",_t,[i[2]||(i[2]=e("p",{class:"info-label"},"有效 Keys 数",-1)),e("p",wt,[i[1]||(i[1]=e("i",{class:"fas fa-check-circle mr-1"},null,-1)),w(a(t(y).activeKeys)+" 个 ",1)])]),t(g).length>0?(r(),l("div",$t,[i[4]||(i[4]=e("p",{class:"info-label"},"无效 Keys 数",-1)),e("p",Ct,[i[3]||(i[3]=e("i",{class:"fas fa-times-circle mr-1"},null,-1)),w(a(t(g).length)+" 个 ",1)])])):I("",!0),e("div",St,[i[5]||(i[5]=e("p",{class:"info-label"},"总请求数",-1)),e("p",Tt,a(u(t(y).usage.requests)),1)]),e("div",At,[i[6]||(i[6]=e("p",{class:"info-label"},"总 Token 数",-1)),e("p",Kt,a(u(t(y).usage.allTokens)),1)]),e("div",Lt,[i[7]||(i[7]=e("p",{class:"info-label"},"总费用",-1)),e("p",Pt,a(t(y).usage.formattedCost),1)]),t($).length>1?(r(),l("div",Mt,[i[8]||(i[8]=e("p",{class:"info-label"},"Top 3 贡献占比",-1)),e("div",It,[(r(!0),l(G,null,Z(O.value,b=>(r(),l("div",{key:b.apiId,class:"contributor-item"},[e("span",Dt,a(b.name),1),e("span",jt,a(p(b))+"%",1)]))),128))])])):I("",!0)])):(r(),l("div",Rt,[e("div",Ot,[i[9]||(i[9]=e("p",{class:"info-label"},"名称",-1)),e("p",qt,a(t(s).name),1)]),e("div",Ut,[i[10]||(i[10]=e("p",{class:"info-label"},"状态",-1)),e("p",{class:U(["info-value font-semibold",t(s).isActive?"text-green-600 dark:text-emerald-400":"text-red-500 dark:text-red-400"])},[e("i",{class:U(["mr-1",t(s).isActive?"fas fa-check-circle":"fas fa-times-circle"])},null,2),w(" "+a(t(s).isActive?"活跃":"已停用"),1)],2)]),e("div",Et,[i[11]||(i[11]=e("p",{class:"info-label"},"权限",-1)),e("p",Nt,a(o(t(s).permissions)),1)]),e("div",Ft,[i[12]||(i[12]=e("p",{class:"info-label"},"创建时间",-1)),e("p",Vt,a(A(t(s).createdAt)),1)]),e("div",Wt,[i[17]||(i[17]=e("p",{class:"info-label"},"过期时间",-1)),e("div",Bt,[t(s).expirationMode==="activation"&&!t(s).isActivated?(r(),l(G,{key:0},[i[13]||(i[13]=e("span",{class:"text-amber-600 dark:text-amber-400"},[e("i",{class:"fas fa-pause-circle mr-1"}),w("未激活 ")],-1)),e("span",zt," 首次使用后 "+a(t(s).activationDays||(t(s).activationUnit==="hours"?24:30))+" "+a(t(s).activationUnit==="hours"?"小时":"天")+"过期 ",1)],64)):t(s).expiresAt?(r(),l(G,{key:1},[C(t(s).expiresAt)?(r(),l("span",Jt,i[14]||(i[14]=[e("i",{class:"fas fa-exclamation-circle mr-1"},null,-1),w("已过期 ",-1)]))):_(t(s).expiresAt)?(r(),l("span",Gt,[i[15]||(i[15]=e("i",{class:"fas fa-clock mr-1"},null,-1)),w(a(F(t(s).expiresAt)),1)])):(r(),l("span",Ht,a(F(t(s).expiresAt)),1))],64)):(r(),l("span",Yt,i[16]||(i[16]=[e("i",{class:"fas fa-infinity mr-1"},null,-1),w("永不过期 ",-1)])))])])]))]),e("div",Qt,[e("header",Xt,[i[18]||(i[18]=e("i",{class:"header-icon fas fa-chart-bar text-green-500"},null,-1)),i[19]||(i[19]=e("h3",{class:"header-title"},"使用统计概览",-1)),e("span",Zt,a(t(v)==="daily"?"今日":"本月"),1)]),e("div",es,[e("div",ts,[e("p",ss,a(u(t(c).requests)),1),e("p",as,a(t(v)==="daily"?"今日":"本月")+"请求数",1)]),e("div",rs,[e("p",ls,a(u(t(c).allTokens)),1),e("p",is,a(t(v)==="daily"?"今日":"本月")+"Token 数",1)]),e("div",os,[e("p",ns,a(t(c).formattedCost||"$0.000000"),1),e("p",ds,a(t(v)==="daily"?"今日":"本月")+"费用",1)]),e("div",us,[e("p",cs,a(u(t(c).inputTokens)),1),e("p",ms,a(t(v)==="daily"?"今日":"本月")+"输入 Token",1)])])])]),!t(x)&&j.value.length>0?(r(),l("div",gs,[i[21]||(i[21]=e("header",{class:"section-header"},[e("i",{class:"header-icon fas fa-plug text-indigo-500"}),e("h3",{class:"header-title"},"专属账号运行状态"),e("span",{class:"header-tag"},"实时更新")],-1)),e("div",{class:U(["grid grid-cols-1 gap-4",f.value])},[(r(!0),l(G,null,Z(j.value,b=>{var D,W,m,T,q,J;return r(),l("div",{key:b.id||b.key,class:"account-card"},[e("div",fs,[e("div",xs,[e("span",{class:U(["account-icon",b.platform==="claude"?"icon-claude":"icon-openai"])},[e("i",{class:U(b.platform==="claude"?"fas fa-meteor":"fas fa-robot")},null,2)],2),e("div",null,[e("p",ys,a(S(b)),1),e("p",ps,a(b.platform==="claude"?"会话窗口":"额度窗口"),1)])]),R(b.rateLimitStatus)?(r(),l("div",{key:0,class:U(["rate-badge",R(b.rateLimitStatus).class])},[i[20]||(i[20]=e("i",{class:"fas fa-tachometer-alt mr-1"},null,-1)),w(" "+a(R(b.rateLimitStatus).text),1)],2)):I("",!0)]),b.platform==="claude"?(r(),l("div",vs,[e("div",bs,[e("div",ks,[e("div",{class:U(["progress-bar",ie((D=b.sessionWindow)==null?void 0:D.sessionWindowStatus,b)]),style:me({width:`${Math.min(100,Math.max(0,((W=b.sessionWindow)==null?void 0:W.progress)||0))}%`})},null,6)]),e("span",hs,a(Math.min(100,Math.max(0,Math.round(((m=b.sessionWindow)==null?void 0:m.progress)||0))))+"% ",1)]),e("div",_s,[e("span",null,a(V((T=b.sessionWindow)==null?void 0:T.windowStart,(q=b.sessionWindow)==null?void 0:q.windowEnd)),1),((J=b.sessionWindow)==null?void 0:J.remainingTime)>0?(r(),l("span",ws," 剩余 "+a(Q(b.sessionWindow.remainingTime)),1)):I("",!0)])])):b.platform==="openai"?(r(),l("div",$s,[b.codexUsage?(r(),l("div",Cs,[(r(),l(G,null,Z(["primary","secondary"],N=>{var H,oe,fe,xe;return e("div",{key:`${b.key}-${N}`,class:"quota-row"},[e("div",Ss,[e("span",{class:U(["quota-tag",N==="primary"?"tag-indigo":"tag-blue"])},a(de(N)),3),e("span",Ts,a(re((H=b.codexUsage)==null?void 0:H[N])),1)]),e("div",As,[e("div",{class:U(["progress-bar",K((oe=b.codexUsage)==null?void 0:oe[N])]),style:me({width:X((fe=b.codexUsage)==null?void 0:fe[N])})},null,6)]),e("div",Ks," 重置剩余 "+a(ee((xe=b.codexUsage)==null?void 0:xe[N])),1)])}),64))])):(r(),l("p",Ls," 暂无额度使用数据 "))])):I("",!0)])}),128))],2)])):I("",!0)]))}},Ms=ne(Ps,[["__scopeId","data-v-b72df2cd"]]),Is={class:"card p-4 md:p-6"},Ds={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},js={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},Rs={class:"space-y-2 md:space-y-3"},Os={class:"flex items-center justify-between"},qs={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Us={class:"flex items-center justify-between"},Es={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Ns={class:"flex items-center justify-between"},Fs={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Vs={class:"flex items-center justify-between"},Ws={class:"text-sm font-medium text-gray-900 dark:text-gray-100 md:text-base"},Bs={class:"mt-3 border-t border-gray-200 pt-3 dark:border-gray-700 md:mt-4 md:pt-4"},zs={class:"flex items-center justify-between font-bold text-gray-900 dark:text-gray-100"},Js={class:"text-sm md:text-base"},Gs={class:"text-lg md:text-xl"},Hs={__name:"TokenDistribution",setup(z){const h=ce(),{statsPeriod:s,currentPeriodData:v}=ue(h),c=x=>(typeof x!="number"&&(x=parseInt(x)||0),x===0?"0":x>=1e6?(x/1e6).toFixed(1)+"M":x>=1e3?(x/1e3).toFixed(1)+"K":x.toLocaleString());return(x,y)=>(r(),l("div",Is,[e("h3",Ds,[y[0]||(y[0]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-coins mr-2 text-sm text-yellow-500 md:mr-3 md:text-base"}),w(" Token 使用分布 ")],-1)),e("span",js,"("+a(t(s)==="daily"?"今日":"本月")+")",1)]),e("div",Rs,[e("div",Os,[y[1]||(y[1]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-arrow-right mr-1 text-xs text-green-500 md:mr-2 md:text-sm"}),w(" 输入 Token ")],-1)),e("span",qs,a(c(t(v).inputTokens)),1)]),e("div",Us,[y[2]||(y[2]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-arrow-left mr-1 text-xs text-blue-500 md:mr-2 md:text-sm"}),w(" 输出 Token ")],-1)),e("span",Es,a(c(t(v).outputTokens)),1)]),e("div",Ns,[y[3]||(y[3]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-save mr-1 text-xs text-purple-500 md:mr-2 md:text-sm"}),w(" 缓存创建 Token ")],-1)),e("span",Fs,a(c(t(v).cacheCreateTokens)),1)]),e("div",Vs,[y[4]||(y[4]=e("span",{class:"flex items-center text-sm text-gray-600 dark:text-gray-400 md:text-base"},[e("i",{class:"fas fa-download mr-1 text-xs text-orange-500 md:mr-2 md:text-sm"}),w(" 缓存读取 Token ")],-1)),e("span",Ws,a(c(t(v).cacheReadTokens)),1)])]),e("div",Bs,[e("div",zs,[e("span",Js,a(t(s)==="daily"?"今日":"本月")+"总计",1),e("span",Gs,a(c(t(v).allTokens)),1)])])]))}},Ys=ne(Hs,[["__scopeId","data-v-d9e5c1dd"]]),Qs={class:"flex h-full flex-col gap-4 md:gap-6"},Xs={class:"card flex h-full flex-col p-4 md:p-6"},Zs={class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},ea={key:0,class:"space-y-4"},ta={class:"rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:from-blue-900/20 dark:to-indigo-900/20"},sa={class:"mb-3 flex items-center justify-between"},aa={class:"rounded-full bg-blue-100 px-2 py-1 text-xs font-semibold text-blue-700 dark:bg-blue-800 dark:text-blue-200"},ra={class:"grid grid-cols-2 gap-3"},la={class:"text-center"},ia={class:"text-lg font-bold text-gray-900 dark:text-gray-100"},oa={class:"text-center"},na={class:"text-lg font-bold text-green-600"},da={class:"rounded-lg bg-gradient-to-r from-purple-50 to-pink-50 p-4 dark:from-purple-900/20 dark:to-pink-900/20"},ua={class:"space-y-2"},ca={class:"flex items-center justify-between"},ma={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ga={class:"flex items-center justify-between"},fa={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},xa={class:"flex items-center justify-between"},ya={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},pa={key:0,class:"rounded-lg bg-red-50 p-3 text-sm dark:bg-red-900/20"},va={class:"text-red-700 dark:text-red-300"},ba={key:1,class:"space-y-4 md:space-y-5"},ka={class:"mb-2 flex items-center justify-between"},ha={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},_a={key:0},wa={key:1,class:"flex items-center gap-1"},$a={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Ca={key:1,class:"h-2 w-full rounded-full bg-gray-200"},Sa={class:"mb-2 flex items-center justify-between"},Ta={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},Aa={key:0},Ka={key:1,class:"flex items-center gap-1"},La={key:0,class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Pa={key:1,class:"h-2 w-full rounded-full bg-gray-200"},Ma={key:0},Ia={class:"mb-2 flex items-center justify-between"},Da={class:"text-xs text-gray-500 dark:text-gray-400 md:text-sm"},ja={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},Ra={key:1},Oa={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},qa={key:0},Ua={key:1},Ea={key:2},Na={class:"space-y-4 border-t border-gray-100 pt-3 dark:border-gray-700"},Fa={class:"flex items-center justify-between"},Va={class:"text-sm font-medium text-gray-900 md:text-base"},Wa={key:0},Ba={key:1,class:"flex items-center gap-1"},za={class:"flex items-center justify-between"},Ja={class:"text-sm font-medium text-gray-900 md:text-base"},Ga={key:0,class:"text-orange-600"},Ha={key:1,class:"text-green-600"},Ya={class:"space-y-2"},Qa={class:"flex items-center justify-between"},Xa={class:"text-sm font-medium text-gray-900 md:text-base"},Za={key:0,class:"text-orange-600"},er={key:1,class:"text-green-600"},tr={key:0,class:"flex flex-wrap gap-2 rounded-lg bg-blue-50 p-2 dark:bg-blue-900/20 md:p-3"},sr={key:0,class:"card !overflow-visible p-4 md:p-6"},ar={class:"rounded-lg border border-amber-200 bg-amber-50 p-3 dark:border-amber-800 dark:bg-amber-900/20 md:p-4"},rr={class:"max-h-64 space-y-1 overflow-y-auto pr-1 md:max-h-80 md:space-y-2"},lr={class:"break-all text-gray-800 dark:text-gray-200"},ir={__name:"LimitConfig",setup(z){const h=ce(),{statsData:s,multiKeyMode:v,aggregatedStats:c,invalidKeys:x}=ue(h),y=L(()=>{var o;const u=(o=s.value)==null?void 0:o.restrictions;return u?u.enableModelRestriction===!0&&Array.isArray(u.restrictedModels)&&u.restrictedModels.length>0:!1}),$=L(()=>{var o;const u=(o=s.value)==null?void 0:o.restrictions;return u?u.enableClientRestriction===!0&&Array.isArray(u.allowedClients)&&u.allowedClients.length>0:!1}),g=()=>{if(!s.value.limits.dailyCostLimit||s.value.limits.dailyCostLimit===0)return 0;const u=s.value.limits.currentDailyCost/s.value.limits.dailyCostLimit*100;return Math.min(u,100)},O=()=>{const u=g();return u>=100?"bg-red-500":u>=80?"bg-yellow-500":"bg-green-500"},p=()=>{if(!s.value.limits.totalCostLimit||s.value.limits.totalCostLimit===0)return 0;const u=s.value.limits.currentTotalCost/s.value.limits.totalCostLimit*100;return Math.min(u,100)},A=()=>{const u=p();return u>=100?"bg-red-500":u>=80?"bg-yellow-500":"bg-blue-500"},F=()=>{if(!s.value.limits.weeklyOpusCostLimit||s.value.limits.weeklyOpusCostLimit===0)return 0;const u=s.value.limits.weeklyOpusCost/s.value.limits.weeklyOpusCostLimit*100;return Math.min(u,100)},C=()=>{const u=F();return u>=100?"bg-red-500":u>=80?"bg-yellow-500":"bg-indigo-500"},_=u=>(typeof u!="number"&&(u=parseInt(u)||0),u===0?"0":u>=1e6?(u/1e6).toFixed(1)+"M":u>=1e3?(u/1e3).toFixed(1)+"K":u.toLocaleString());return(u,o)=>(r(),l("div",Qs,[e("div",Xs,[e("h3",Zs,[o[0]||(o[0]=e("i",{class:"fas fa-shield-alt mr-2 text-sm text-red-500 md:mr-3 md:text-base"},null,-1)),w(" "+a(t(v)?"限制配置（聚合查询模式）":"限制配置"),1)]),t(v)&&t(c)?(r(),l("div",ea,[e("div",ta,[e("div",sa,[o[1]||(o[1]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-layer-group mr-2 text-blue-500"}),w(" API Keys 概况 ")],-1)),e("span",aa,a(t(c).activeKeys)+"/"+a(t(c).totalKeys),1)]),e("div",ra,[e("div",la,[e("div",ia,a(t(c).totalKeys),1),o[2]||(o[2]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"总计 Keys",-1))]),e("div",oa,[e("div",na,a(t(c).activeKeys),1),o[3]||(o[3]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400"},"激活 Keys",-1))])])]),e("div",da,[o[7]||(o[7]=e("div",{class:"mb-3 flex items-center"},[e("i",{class:"fas fa-chart-pie mr-2 text-purple-500"}),e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"聚合统计摘要")],-1)),e("div",ua,[e("div",ca,[o[4]||(o[4]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-database mr-1 text-gray-400"}),w(" 总请求数 ")],-1)),e("span",ma,a(_(t(c).usage.requests)),1)]),e("div",ga,[o[5]||(o[5]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-coins mr-1 text-yellow-500"}),w(" 总 Tokens ")],-1)),e("span",fa,a(_(t(c).usage.allTokens)),1)]),e("div",xa,[o[6]||(o[6]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-dollar-sign mr-1 text-green-500"}),w(" 总费用 ")],-1)),e("span",ya,a(t(c).usage.formattedCost),1)])])]),t(x)&&t(x).length>0?(r(),l("div",pa,[o[8]||(o[8]=e("i",{class:"fas fa-exclamation-triangle mr-2 text-red-600 dark:text-red-400"},null,-1)),e("span",va,a(t(x).length)+" 个无效的 API Key ",1)])):I("",!0),o[9]||(o[9]=e("div",{class:"rounded-lg bg-gray-50 p-3 text-xs text-gray-600 dark:bg-gray-800 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),w(" 每个 API Key 有独立的限制设置，聚合模式下不显示单个限制配置 ")],-1))])):I("",!0),t(v)?I("",!0):(r(),l("div",ba,[e("div",null,[e("div",ka,[o[11]||(o[11]=e("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"每日费用限制",-1)),e("span",ha,[t(s).limits.dailyCostLimit>0?(r(),l("span",_a," $"+a(t(s).limits.currentDailyCost.toFixed(4))+" / $"+a(t(s).limits.dailyCostLimit.toFixed(2)),1)):(r(),l("span",wa,[w(" $"+a(t(s).limits.currentDailyCost.toFixed(4))+" / ",1),o[10]||(o[10]=e("i",{class:"fas fa-infinity"},null,-1))]))])]),t(s).limits.dailyCostLimit>0?(r(),l("div",$a,[e("div",{class:U(["h-2 rounded-full transition-all duration-300",O()]),style:me({width:g()+"%"})},null,6)])):(r(),l("div",Ca,o[12]||(o[12]=[e("div",{class:"h-2 rounded-full bg-green-500",style:{width:"0%"}},null,-1)])))]),e("div",null,[e("div",Sa,[o[14]||(o[14]=e("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"总费用限制",-1)),e("span",Ta,[t(s).limits.totalCostLimit>0?(r(),l("span",Aa," $"+a(t(s).limits.currentTotalCost.toFixed(4))+" / $"+a(t(s).limits.totalCostLimit.toFixed(2)),1)):(r(),l("span",Ka,[w(" $"+a(t(s).limits.currentTotalCost.toFixed(4))+" / ",1),o[13]||(o[13]=e("i",{class:"fas fa-infinity"},null,-1))]))])]),t(s).limits.totalCostLimit>0?(r(),l("div",La,[e("div",{class:U(["h-2 rounded-full transition-all duration-300",A()]),style:me({width:p()+"%"})},null,6)])):(r(),l("div",Pa,o[15]||(o[15]=[e("div",{class:"h-2 rounded-full bg-blue-500",style:{width:"0%"}},null,-1)])))]),t(s).limits.weeklyOpusCostLimit>0?(r(),l("div",Ma,[e("div",Ia,[o[16]||(o[16]=e("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 md:text-base"},"Opus 模型周费用限制",-1)),e("span",Da," $"+a(t(s).limits.weeklyOpusCost.toFixed(4))+" / $"+a(t(s).limits.weeklyOpusCostLimit.toFixed(2)),1)]),e("div",ja,[e("div",{class:U(["h-2 rounded-full transition-all duration-300",C()]),style:me({width:F()+"%"})},null,6)])])):I("",!0),t(s).limits.rateLimitWindow>0&&(t(s).limits.rateLimitRequests>0||t(s).limits.tokenLimit>0||t(s).limits.rateLimitCost>0)?(r(),l("div",Ra,[se(Be,{"cost-limit":t(s).limits.rateLimitCost,"current-cost":t(s).limits.currentWindowCost,"current-requests":t(s).limits.currentWindowRequests,"current-tokens":t(s).limits.currentWindowTokens,label:"时间窗口限制","rate-limit-window":t(s).limits.rateLimitWindow,"request-limit":t(s).limits.rateLimitRequests,"show-progress":!0,"show-tooltip":!0,"token-limit":t(s).limits.tokenLimit,"window-end-time":t(s).limits.windowEndTime,"window-remaining-seconds":t(s).limits.windowRemainingSeconds,"window-start-time":t(s).limits.windowStartTime},null,8,["cost-limit","current-cost","current-requests","current-tokens","rate-limit-window","request-limit","token-limit","window-end-time","window-remaining-seconds","window-start-time"]),e("div",Oa,[o[17]||(o[17]=e("i",{class:"fas fa-info-circle mr-1"},null,-1)),t(s).limits.rateLimitCost>0?(r(),l("span",qa,' 请求次数和费用限制为"或"的关系，任一达到限制即触发限流 ')):t(s).limits.tokenLimit>0?(r(),l("span",Ua,' 请求次数和Token使用量为"或"的关系，任一达到限制即触发限流 ')):(r(),l("span",Ea," 仅限制请求次数 "))])])):I("",!0),e("div",Na,[e("div",Fa,[o[19]||(o[19]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"并发限制",-1)),e("span",Va,[t(s).limits.concurrencyLimit>0?(r(),l("span",Wa,a(t(s).limits.concurrencyLimit),1)):(r(),l("span",Ba,o[18]||(o[18]=[e("i",{class:"fas fa-infinity text-gray-400"},null,-1)])))])]),e("div",za,[o[22]||(o[22]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"模型限制",-1)),e("span",Ja,[y.value?(r(),l("span",Ga,[o[20]||(o[20]=e("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),w(" 限制 "+a(t(s).restrictions.restrictedModels.length)+" 个模型 ",1)])):(r(),l("span",Ha,o[21]||(o[21]=[e("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),w(" 允许所有模型 ",-1)])))])]),e("div",Ya,[e("div",Qa,[o[25]||(o[25]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"客户端限制",-1)),e("span",Xa,[$.value?(r(),l("span",Za,[o[23]||(o[23]=e("i",{class:"fas fa-exclamation-triangle mr-1 text-xs md:text-sm"},null,-1)),w(" 限 "+a(t(s).restrictions.allowedClients.length)+" 种客户端使用 ",1)])):(r(),l("span",er,o[24]||(o[24]=[e("i",{class:"fas fa-check-circle mr-1 text-xs md:text-sm"},null,-1),w(" 允许所有客户端 ",-1)])))])]),$.value?(r(),l("div",tr,[(r(!0),l(G,null,Z(t(s).restrictions.allowedClients,j=>(r(),l("span",{key:j,class:"flex items-center gap-1 rounded-full bg-white px-2 py-1 text-xs text-blue-700 shadow-sm dark:bg-slate-900 dark:text-blue-300 md:text-sm"},[o[26]||(o[26]=e("i",{class:"fas fa-id-badge"},null,-1)),w(" "+a(j),1)]))),128))])):I("",!0)])])]))]),y.value?(r(),l("div",sr,[o[30]||(o[30]=e("h3",{class:"mb-3 flex items-center text-lg font-bold text-gray-900 dark:text-gray-100 md:mb-4 md:text-xl"},[e("i",{class:"fas fa-list-alt mr-2 text-sm text-amber-500 md:mr-3 md:text-base"}),w(" 详细限制信息 ")],-1)),e("div",ar,[o[28]||(o[28]=e("h4",{class:"mb-2 flex items-center text-sm font-bold text-amber-800 dark:text-amber-300 md:mb-3 md:text-base"},[e("i",{class:"fas fa-robot mr-1 text-xs md:mr-2 md:text-sm"}),w(" 受限模型列表 ")],-1)),e("div",rr,[(r(!0),l(G,null,Z(t(s).restrictions.restrictedModels,j=>(r(),l("div",{key:j,class:"rounded border border-amber-200 bg-white px-2 py-1 text-xs dark:border-amber-700 dark:bg-gray-800 md:px-3 md:py-2 md:text-sm"},[o[27]||(o[27]=e("i",{class:"fas fa-ban mr-1 text-xs text-red-500 md:mr-2"},null,-1)),e("span",lr,a(j),1)]))),128))]),o[29]||(o[29]=e("p",{class:"mt-2 text-xs text-amber-700 dark:text-amber-400 md:mt-3"},[e("i",{class:"fas fa-info-circle mr-1"}),w(" 此 API Key 不能访问以上列出的模型 ")],-1))])])):I("",!0)]))}},or=ne(ir,[["__scopeId","data-v-9bba2ba4"]]),nr={class:"card h-full p-4 md:p-6"},dr={class:"mb-3 flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:mb-4 md:text-xl"},ur={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},cr={key:0,class:"space-y-2 md:space-y-3"},mr={class:"mb-1 flex items-center justify-between text-sm"},gr={class:"truncate font-medium text-gray-700 dark:text-gray-300"},fr={class:"text-xs text-gray-600 dark:text-gray-400"},xr={class:"h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},yr={class:"mt-1 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},pr={key:0,class:"border-t border-gray-200 pt-2 dark:border-gray-700"},vr={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},br={key:1,class:"flex h-32 items-center justify-center text-sm text-gray-500 dark:text-gray-400"},kr={key:2,class:"flex h-32 items-center justify-center text-sm text-gray-500 dark:text-gray-400"},hr={__name:"AggregatedStatsCard",setup(z){const h=ce(),{aggregatedStats:s,individualStats:v,statsPeriod:c,multiKeyMode:x}=ue(h),y=C=>C?c.value==="daily"?C.dailyUsage||C.usage:C.monthlyUsage||C.usage:null,$=L(()=>!v.value||v.value.length===0?[]:[...v.value].sort((C,_)=>{const u=y(C),o=y(_);return((o==null?void 0:o.cost)||0)-((u==null?void 0:u.cost)||0)}).slice(0,5)),g=L(()=>v.value?Math.max(0,v.value.length-5):0),O=L(()=>{var o,j;if(!v.value||!s.value)return 0;const C=$.value.reduce((f,S)=>{const E=y(S);return f+((E==null?void 0:E.cost)||0)},0),_=c.value==="daily"?((o=s.value.dailyUsage)==null?void 0:o.cost)||0:((j=s.value.monthlyUsage)==null?void 0:j.cost)||0;if(_===0)return 0;const u=_-C;return Math.max(0,Math.round(u/_*100))}),p=C=>{var j,f;if(!s.value)return 0;const _=c.value==="daily"?((j=s.value.dailyUsage)==null?void 0:j.cost)||0:((f=s.value.monthlyUsage)==null?void 0:f.cost)||0;if(_===0)return 0;const u=y(C),o=((u==null?void 0:u.cost)||0)/_*100;return Math.round(o)},A=C=>["bg-blue-500","bg-green-500","bg-purple-500","bg-yellow-500","bg-pink-500"][C]||"bg-gray-400",F=C=>(typeof C!="number"&&(C=parseInt(C)||0),C===0?"0":C>=1e6?(C/1e6).toFixed(1)+"M":C>=1e3?(C/1e3).toFixed(1)+"K":C.toLocaleString());return(C,_)=>(r(),l("div",nr,[e("h3",dr,[_[0]||(_[0]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-chart-pie mr-2 text-sm text-orange-500 md:mr-3 md:text-base"}),w(" 使用占比 ")],-1)),e("span",ur,"("+a(t(c)==="daily"?"今日":"本月")+")",1)]),t(s)&&t(v).length>0?(r(),l("div",cr,[(r(!0),l(G,null,Z($.value,(u,o)=>{var j,f;return r(),l("div",{key:u.apiId,class:"relative"},[e("div",mr,[e("span",gr,a(u.name||`Key ${o+1}`),1),e("span",fr,a(p(u))+"% ",1)]),e("div",xr,[e("div",{class:U(["h-2 rounded-full transition-all duration-300",A(o)]),style:me({width:p(u)+"%"})},null,6)]),e("div",yr,[e("span",null,a(F(((j=y(u))==null?void 0:j.requests)||0))+"次",1),e("span",null,a(((f=y(u))==null?void 0:f.formattedCost)||"$0.00"),1)])])}),128)),g.value>0?(r(),l("div",pr,[e("div",vr,[e("span",null,"其他 "+a(g.value)+" 个Keys",1),e("span",null,a(O.value)+"%",1)])])):I("",!0)])):t(x)?(r(),l("div",kr,_[2]||(_[2]=[e("i",{class:"fas fa-chart-pie mr-2"},null,-1),w(" 暂无数据 ",-1)]))):(r(),l("div",br,_[1]||(_[1]=[e("div",{class:"text-center"},[e("i",{class:"fas fa-chart-pie mb-2 text-2xl"}),e("p",null,"使用占比仅在多Key查询时显示")],-1)])))]))}},_r=ne(hr,[["__scopeId","data-v-39572a8e"]]),wr={class:"card p-4 md:p-6"},$r={class:"mb-4 md:mb-6"},Cr={class:"flex flex-col text-lg font-bold text-gray-900 dark:text-gray-100 sm:flex-row sm:items-center md:text-xl"},Sr={class:"text-xs font-normal text-gray-600 dark:text-gray-400 sm:ml-2 md:text-sm"},Tr={key:0,class:"py-6 text-center md:py-8"},Ar={key:1,class:"space-y-3 md:space-y-4"},Kr={class:"mb-2 flex items-start justify-between md:mb-3"},Lr={class:"min-w-0 flex-1"},Pr={class:"break-all text-base font-bold text-gray-900 dark:text-gray-100 md:text-lg"},Mr={class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},Ir={class:"ml-3 flex-shrink-0 text-right"},Dr={class:"text-base font-bold text-green-600 md:text-lg"},jr={class:"grid grid-cols-2 gap-2 text-xs md:grid-cols-4 md:gap-3 md:text-sm"},Rr={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},Or={class:"font-medium text-gray-900 dark:text-gray-100"},qr={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},Ur={class:"font-medium text-gray-900 dark:text-gray-100"},Er={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},Nr={class:"font-medium text-gray-900 dark:text-gray-100"},Fr={class:"rounded bg-gray-50 p-2 dark:bg-gray-700"},Vr={class:"font-medium text-gray-900 dark:text-gray-100"},Wr={key:2,class:"py-6 text-center text-gray-500 dark:text-gray-400 md:py-8"},Br={class:"text-sm md:text-base"},zr={__name:"ModelUsageStats",setup(z){const h=ce(),{statsPeriod:s,modelStats:v,modelStatsLoading:c}=ue(h),x=y=>(typeof y!="number"&&(y=parseInt(y)||0),y===0?"0":y>=1e6?(y/1e6).toFixed(1)+"M":y>=1e3?(y/1e3).toFixed(1)+"K":y.toLocaleString());return(y,$)=>(r(),l("div",wr,[e("div",$r,[e("h3",Cr,[$[0]||($[0]=e("span",{class:"flex items-center"},[e("i",{class:"fas fa-robot mr-2 text-sm text-indigo-500 md:mr-3 md:text-base"}),w(" 模型使用统计 ")],-1)),e("span",Sr,"("+a(t(s)==="daily"?"今日":"本月")+")",1)])]),t(c)?(r(),l("div",Tr,$[1]||($[1]=[e("i",{class:"fas fa-spinner loading-spinner mb-2 text-xl text-gray-600 dark:text-gray-400 md:text-2xl"},null,-1),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 md:text-base"},"加载模型统计数据中...",-1)]))):t(v).length>0?(r(),l("div",Ar,[(r(!0),l(G,null,Z(t(v),(g,O)=>{var p;return r(),l("div",{key:O,class:"model-usage-item"},[e("div",Kr,[e("div",Lr,[e("h4",Pr,a(g.model),1),e("p",Mr,a(g.requests)+" 次请求 ",1)]),e("div",Ir,[e("div",Dr,a(((p=g.formatted)==null?void 0:p.total)||"$0.000000"),1),$[2]||($[2]=e("div",{class:"text-xs text-gray-600 dark:text-gray-400 md:text-sm"},"总费用",-1))])]),e("div",jr,[e("div",Rr,[$[3]||($[3]=e("div",{class:"text-gray-600 dark:text-gray-400"},"输入 Token",-1)),e("div",Or,a(x(g.inputTokens)),1)]),e("div",qr,[$[4]||($[4]=e("div",{class:"text-gray-600 dark:text-gray-400"},"输出 Token",-1)),e("div",Ur,a(x(g.outputTokens)),1)]),e("div",Er,[$[5]||($[5]=e("div",{class:"text-gray-600 dark:text-gray-400"},"缓存创建",-1)),e("div",Nr,a(x(g.cacheCreateTokens)),1)]),e("div",Fr,[$[6]||($[6]=e("div",{class:"text-gray-600 dark:text-gray-400"},"缓存读取",-1)),e("div",Vr,a(x(g.cacheReadTokens)),1)])])])}),128))])):(r(),l("div",Wr,[$[7]||($[7]=e("i",{class:"fas fa-chart-pie mb-3 text-2xl md:text-3xl"},null,-1)),e("p",Br," 暂无"+a(t(s)==="daily"?"今日":"本月")+"模型使用数据 ",1)]))]))}},Jr=ne(zr,[["__scopeId","data-v-b3b8dc5f"]]),Gr={class:"merge-card mb-8 rounded-3xl p-6 shadow-xl"},Hr={class:"mx-auto max-w-4xl"},Yr={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Qr=["disabled"],Xr=["disabled"],Zr={class:"mt-4 flex flex-wrap gap-3"},el=["disabled"],tl={key:0,class:"fas fa-spinner loading-spinner"},sl={key:1,class:"fas fa-link"},al=["disabled"],rl={key:0,class:"mt-4"},ll={class:"rounded-xl border border-red-500/30 bg-red-500/10 p-3 text-sm text-red-700 dark:border-red-500/20 dark:bg-red-500/10 dark:text-red-200"},il={key:1,class:"mt-4"},ol={class:"rounded-xl border border-amber-400/40 bg-amber-50 p-3 text-sm text-amber-700 dark:border-amber-400/30 dark:bg-amber-900/20 dark:text-amber-200"},nl={class:"space-y-1"},dl={key:2,class:"mt-4"},ul={class:"rounded-xl border border-emerald-400/40 bg-emerald-50 p-3 text-sm text-emerald-700 dark:border-emerald-400/30 dark:bg-emerald-900/20 dark:text-emerald-200"},cl={class:"mb-2 font-semibold"},ml={class:"space-y-1"},gl={__name:"KeyMergePanel",setup(z){const h=M(""),s=M(""),v=M(!1),c=M(""),x=M(null),y=M([]),$=f=>f.length>=10&&f.length<=512,g=L(()=>{const f=h.value.trim(),S=s.value.trim();return!$(f)||!$(S)?!1:f!==S}),O={concurrencyLimit:"并发限制",rateLimitWindow:"速率窗口",rateLimitRequests:"窗口请求次数",rateLimitCost:"窗口费用限制",tokenLimit:"窗口 Token 限制",claudeAccountId:"Claude 账号绑定",claudeConsoleAccountId:"Claude Console 账号绑定",geminiAccountId:"Gemini 账号绑定",openaiAccountId:"OpenAI 账号绑定",azureOpenaiAccountId:"Azure OpenAI 账号绑定",bedrockAccountId:"Bedrock 账号绑定",droidAccountId:"Droid 账号绑定",permissions:"权限范围",enableModelRestriction:"模型限制开关",restrictedModels:"模型白名单",enableClientRestriction:"客户端限制开关",allowedClients:"允许客户端",tags:"标签",expirationMode:"过期模式",activationUnit:"激活单位",activationDays:"激活有效期",dailyCostLimit:"每日费用额度",totalCostLimit:"总费用额度",weeklyOpusCostLimit:"Opus 周费用额度",expiresAt:"到期时间"},p=f=>O[f]||f,A=(f,S)=>S==="permissions"&&Array.isArray(f)&&f.length===0?"全部":Array.isArray(f)?f.length?f.join(", "):"无":f===""||f===null||f===void 0?"无":String(f),F=(f,S=!1)=>{const E=S?f.source:f.target;return A(E,f.field)},C=L(()=>{var R;if(!((R=x.value)!=null&&R.merged))return[];const f=x.value.merged,S=f.activationUnit==="hours"?"小时":"天";return[{field:"totalCostLimit",label:"总费用额度",value:f.totalCostLimit},{field:"dailyCostLimit",label:"每日费用额度",value:f.dailyCostLimit},{field:"weeklyOpusCostLimit",label:"Opus 周费用额度",value:f.weeklyOpusCostLimit},{field:"rateLimitCost",label:"窗口费用限制",value:f.rateLimitCost},{field:"rateLimitRequests",label:"窗口请求次数",value:f.rateLimitRequests},{field:"tokenLimit",label:"窗口 Token 限制",value:f.tokenLimit},{field:"activationDays",label:"激活有效期",value:f.activationDays&&f.activationDays>0?`${f.activationDays} ${S}`:f.activationDays,rawValue:f.activationDays},{field:"expiresAt",label:"到期时间",value:f.expiresAt}].filter(V=>{if(V.field==="expiresAt")return V.value!==void 0&&V.value!==null&&V.value!=="";const Q=Number(V.rawValue??V.value);return Number.isFinite(Q)&&Q>0}).map(V=>({...V,value:A(V.value,V.field)}))}),_=L(()=>{var f;return((f=x.value)==null?void 0:f.action)==="replace"?"替换成功":"融合成功"}),u=L(()=>{var f;return((f=x.value)==null?void 0:f.action)==="replace"?"旧密钥已替换为新密钥配置，新密钥已禁用。":"旧密钥额度已合并，新密钥已禁用。"}),o=async()=>{var f,S,E;if(!g.value){c.value="请填写有效的旧密钥和新密钥";return}v.value=!0,c.value="",x.value=null,y.value=[];try{const R=await ae.mergeKeys({targetApiKey:h.value.trim(),sourceApiKey:s.value.trim()});if(R!=null&&R.success)x.value=R.data;else throw new Error((R==null?void 0:R.message)||"密钥融合失败")}catch(R){c.value=((f=R==null?void 0:R.data)==null?void 0:f.message)||(R==null?void 0:R.message)||"密钥融合失败",y.value=((E=(S=R==null?void 0:R.data)==null?void 0:S.details)==null?void 0:E.mismatchFields)||[]}finally{v.value=!1}},j=()=>{h.value="",s.value="",c.value="",x.value=null,y.value=[]};return ve([h,s],()=>{c.value&&(c.value=""),y.value=[],x.value=null}),(f,S)=>(r(),l("div",Gr,[S[8]||(S[8]=e("div",{class:"mb-6"},[e("h2",{class:"mb-2 text-2xl font-bold text-gray-900 dark:text-gray-200"},[e("i",{class:"fas fa-link mr-3"}),w(" 密钥融合 ")]),e("p",{class:"text-base text-gray-600 dark:text-gray-400"}," 将新密钥额度合并到旧密钥中；若旧密钥已禁用，则直接用新密钥配置替换旧密钥。完成后新密钥会被禁用。 ")],-1)),e("div",Hr,[e("div",Yr,[e("div",null,[S[2]||(S[2]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-key mr-2"}),w(" 旧密钥（保留使用） ")],-1)),ge(e("input",{"onUpdate:modelValue":S[0]||(S[0]=E=>h.value=E),class:"merge-input w-full",disabled:v.value,placeholder:"请输入旧密钥 (cr_...)",type:"password",autocomplete:"off"},null,8,Qr),[[ke,h.value]])]),e("div",null,[S[3]||(S[3]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-key mr-2"}),w(" 新密钥（将被禁用） ")],-1)),ge(e("input",{"onUpdate:modelValue":S[1]||(S[1]=E=>s.value=E),class:"merge-input w-full",disabled:v.value,placeholder:"请输入新密钥 (cr_...)",type:"password",autocomplete:"off"},null,8,Xr),[[ke,s.value]])])]),e("div",Zr,[e("button",{class:"merge-button flex items-center justify-center gap-2",disabled:v.value||!g.value,onClick:o},[v.value?(r(),l("i",tl)):(r(),l("i",sl)),w(" "+a(v.value?"融合中...":"开始融合"),1)],8,el),e("button",{class:"merge-clear",disabled:v.value,onClick:j}," 清空输入 ",8,al)]),S[6]||(S[6]=e("div",{class:"merge-notice mt-4"},[e("i",{class:"fas fa-shield-alt mr-2"}),w(" 密钥融合仅在两把密钥设置一致且新密钥未使用时可执行（天卡有效期天数、按量总量额度允许不一致）；旧密钥已禁用时将直接替换配置并保留旧密钥。 ")],-1)),c.value?(r(),l("div",rl,[e("div",ll,[S[4]||(S[4]=e("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1)),w(" "+a(c.value),1)])])):I("",!0),y.value.length?(r(),l("div",il,[e("div",ol,[S[5]||(S[5]=e("div",{class:"mb-2 font-semibold"},"以下设置不一致：",-1)),e("ul",nl,[(r(!0),l(G,null,Z(y.value,E=>(r(),l("li",{key:E.field},a(p(E.field))+"：旧= "+a(F(E))+"，新= "+a(F(E,!0)),1))),128))])])])):I("",!0),x.value?(r(),l("div",dl,[e("div",ul,[e("div",cl,a(_.value),1),e("div",ml,[e("div",null,a(u.value),1),(r(!0),l(G,null,Z(C.value,E=>(r(),l("div",{key:E.field},a(E.label)+"："+a(E.value),1))),128))])])])):I("",!0),S[7]||(S[7]=e("div",{class:"merge-notice mt-3 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-lock mr-2"}),w(" 密钥仅用于本次融合操作，不会被存储。 ")],-1))])]))}},fl=ne(gl,[["__scopeId","data-v-966fb730"]]),xl={key:0,class:"fixed inset-0 z-[1050] flex items-center justify-center bg-gray-900/40 backdrop-blur-sm"},yl={class:"relative z-10 mx-3 flex w-full max-w-lg flex-col overflow-hidden rounded-2xl border border-gray-200/70 bg-white/95 shadow-2xl ring-1 ring-black/5 transition-all dark:border-gray-700/60 dark:bg-gray-900/95 dark:ring-white/10 sm:mx-4"},pl={class:"flex items-center justify-between border-b border-gray-100 bg-white/80 px-5 py-4 backdrop-blur dark:border-gray-800 dark:bg-gray-900/80"},vl={class:"flex items-center gap-3"},bl={class:"text-xs text-gray-500 dark:text-gray-400"},kl=["disabled"],hl={class:"max-h-[70vh] overflow-y-auto px-5 py-4"},_l={class:"mb-4"},wl={class:"relative"},$l=["value"],Cl={class:"mb-4 grid grid-cols-1 gap-3 sm:grid-cols-2"},Sl=["disabled"],Tl=["value"],Al={class:"mt-1 text-[11px] text-gray-500 dark:text-gray-400"},Kl=["disabled"],Ll=["value"],Pl={class:"mb-4 space-y-2"},Ml={class:"flex items-center justify-between text-sm"},Il={class:"inline-flex items-center gap-1.5 rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-700 dark:bg-blue-500/20 dark:text-blue-300"},Dl={class:"flex items-center justify-between text-sm"},jl={class:"font-medium text-gray-700 dark:text-gray-300"},Rl={class:"flex items-center justify-between text-sm"},Ol={class:"font-medium text-gray-700 dark:text-gray-300"},ql={class:"mb-4 rounded-xl border border-indigo-200/70 bg-indigo-50/70 p-3 dark:border-indigo-500/30 dark:bg-indigo-900/20"},Ul={class:"mb-2 flex items-center justify-between"},El=["disabled"],Nl={key:0,class:"flex items-center gap-2 text-xs text-indigo-600 dark:text-indigo-200"},Fl={key:1,class:"rounded-md border border-red-200 bg-red-50 px-2 py-1.5 text-xs text-red-600 dark:border-red-500/30 dark:bg-red-900/20 dark:text-red-300"},Vl={key:2,class:"space-y-2"},Wl={class:"grid grid-cols-1 gap-1.5 text-xs text-gray-600 dark:text-gray-300 sm:grid-cols-2"},Bl={class:"flex items-center justify-between rounded-md bg-white/70 px-2 py-1 dark:bg-gray-900/40"},zl={class:"font-medium text-gray-800 dark:text-gray-100"},Jl={class:"flex items-center justify-between rounded-md bg-white/70 px-2 py-1 dark:bg-gray-900/40"},Gl={class:"font-medium text-gray-800 dark:text-gray-100"},Hl={class:"flex items-center justify-between rounded-md bg-white/70 px-2 py-1 dark:bg-gray-900/40"},Yl={class:"font-medium text-gray-800 dark:text-gray-100"},Ql={class:"flex items-center justify-between rounded-md bg-white/70 px-2 py-1 dark:bg-gray-900/40"},Xl={class:"font-medium text-gray-800 dark:text-gray-100"},Zl={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},ei={key:1,class:"max-h-32 space-y-1 overflow-y-auto rounded-md border border-indigo-100 bg-white/70 p-2 dark:border-indigo-500/20 dark:bg-gray-900/40"},ti=["title"],si={class:"font-medium text-gray-800 dark:text-gray-100"},ai={class:"ml-1 text-gray-500 dark:text-gray-400"},ri={class:"font-medium text-indigo-600 dark:text-indigo-300"},li={key:3,class:"text-xs text-gray-500 dark:text-gray-400"},ii={class:"flex items-center gap-3"},oi={class:"text-xs text-gray-500 dark:text-gray-400"},ni={key:0,class:"mb-4 overflow-hidden rounded-xl border border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"},di={class:"flex items-center justify-between border-b border-gray-200 bg-gray-100 px-3 py-2 dark:border-gray-700 dark:bg-gray-800"},ui={key:0,class:"text-xs text-gray-500 dark:text-gray-500"},ci={class:"max-h-40 overflow-y-auto p-3"},mi={key:0,class:"whitespace-pre-wrap text-sm text-gray-700 dark:text-gray-300"},gi={key:0,class:"inline-block h-4 w-1 animate-pulse bg-blue-500"},fi={key:1,class:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400"},xi={key:2,class:"text-sm text-red-600 dark:text-red-400"},yi={key:1,class:"mb-4 flex items-center justify-center gap-2 text-xs text-gray-500 dark:text-gray-400"},pi={class:"flex items-center justify-end gap-3 border-t border-gray-100 bg-gray-50/80 px-5 py-3 dark:border-gray-800 dark:bg-gray-900/50"},vi=["disabled"],bi=["disabled"],ki={__name:"ApiKeyTestModal",props:{show:{type:Boolean,default:!1},apiKeyValue:{type:String,default:""},apiKeyName:{type:String,default:""},apiKeyProfile:{type:Object,default:null}},emits:["close"],setup(z,{emit:h}){const s=z,v=h,c={claude:{label:"Claude",endpoint:"/api/v1/messages",client:"Claude Code",defaultModel:"claude-sonnet-4-5-20250929",models:["claude-sonnet-4-5-20250929","claude-opus-4-1-20250805"]},gemini:{label:"Gemini",endpoint:"/gemini/v1beta/models/{model}:generateContent",client:"Gemini CLI",defaultModel:"gemini-2.5-pro",models:["gemini-2.5-pro","gemini-2.5-flash"]},codex:{label:"Codex",endpoint:"/openai/v1/responses",client:"Codex CLI",defaultModel:"gpt-5.2-codex",models:["gpt-5.2-codex","gpt-5","gpt-5-mini"]}};function x(k){return typeof k=="string"&&k.trim().length>0}function y(k){var te;if(!k||typeof k!="object")return"claude";const d=k.accounts||{};if(x(d.openaiAccountId))return"codex";if(x(d.geminiAccountId))return"gemini";if(x(d.claudeAccountId))return"claude";const P=(te=k.restrictions)==null?void 0:te.restrictedModels;if(Array.isArray(P)){const le=P.map(Y=>String(Y).toLowerCase());if(le.some(Y=>Y.includes("gpt")||Y.includes("codex")))return"codex";if(le.some(Y=>Y.includes("gemini")))return"gemini";if(le.some(Y=>Y.includes("claude")))return"claude"}return"claude"}const $={auto:"Auto",manual:"Manual",disabled:"Disabled"},g=M("idle"),O=M(""),p=M(""),A=M(0),F=M(null),C=M(null),_=M(null),u=M(!1),o=M(""),j=M(null),f=M("claude"),S=M(c.claude.defaultModel),E=L(()=>s.apiKeyName||"Current API Key"),R=L(()=>{const k=s.apiKeyValue;return k?k.length<=10?"****":k.substring(0,6)+"****"+k.substring(k.length-4):""}),V=L(()=>c[f.value]||c.claude),Q=L(()=>Object.entries(c).map(([k,d])=>({value:k,label:d.label}))),ie=L(()=>V.value.models),B=L(()=>V.value.endpoint),K=L(()=>V.value.client),X=L(()=>{var k;return((k=_.value)==null?void 0:k.policy)||null}),re=L(()=>{var d;return(((d=_.value)==null?void 0:d.sessions)||[]).slice(0,8)}),ee=L(()=>X.value?X.value.autoRenewEnabled?"Enabled":"Disabled":"--"),de=L(()=>{var d;const k=(d=X.value)==null?void 0:d.renewalMode;return $[k]||"--"}),n=L(()=>{var k;return fe((k=X.value)==null?void 0:k.fullTTLSeconds)}),i=L(()=>{var d;const k=(d=X.value)==null?void 0:d.renewalThresholdSeconds;return k==null?"--":k<=0?"0 min":`${Math.ceil(k/60)} min`}),b=L(()=>{switch(g.value){case"idle":return"Ready";case"testing":return"Testing...";case"success":return"Success";case"error":return"Failed";default:return"Unknown"}}),D=L(()=>{switch(g.value){case"idle":return"Click the button below to start endpoint testing";case"testing":return`Sending request to ${B.value}`;case"success":return"The API key can access this service";case"error":return p.value||"The API key failed to access this service";default:return""}}),W=L(()=>{switch(g.value){case"idle":return"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50";case"testing":return"border-blue-200 bg-blue-50 dark:border-blue-500/30 dark:bg-blue-900/20";case"success":return"border-green-200 bg-green-50 dark:border-green-500/30 dark:bg-green-900/20";case"error":return"border-red-200 bg-red-50 dark:border-red-500/30 dark:bg-red-900/20";default:return"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"}}),m=L(()=>{switch(g.value){case"idle":return"bg-gray-200 dark:bg-gray-700";case"testing":return"bg-blue-100 dark:bg-blue-500/30";case"success":return"bg-green-100 dark:bg-green-500/30";case"error":return"bg-red-100 dark:bg-red-500/30";default:return"bg-gray-200 dark:bg-gray-700"}}),T=L(()=>{switch(g.value){case"idle":return"fa-hourglass-start";case"testing":return"fa-spinner fa-spin";case"success":return"fa-check-circle";case"error":return"fa-exclamation-circle";default:return"fa-question-circle"}}),q=L(()=>{switch(g.value){case"idle":return"text-gray-500 dark:text-gray-400";case"testing":return"text-blue-500 dark:text-blue-400";case"success":return"text-green-500 dark:text-green-400";case"error":return"text-red-500 dark:text-red-400";default:return"text-gray-500 dark:text-gray-400"}}),J=L(()=>{switch(g.value){case"idle":return"text-gray-700 dark:text-gray-300";case"testing":return"text-blue-700 dark:text-blue-300";case"success":return"text-green-700 dark:text-green-300";case"error":return"text-red-700 dark:text-red-300";default:return"text-gray-700 dark:text-gray-300"}}),N=L(()=>y(s.apiKeyProfile)),H=L(()=>{var k;return((k=c[N.value])==null?void 0:k.label)||"Claude"});function oe(){const k=N.value,d=c[k]||c.claude;f.value=k,S.value=d.defaultModel}function fe(k){const d=Number(k);if(!Number.isFinite(d)||d<0)return"--";if(d<60)return`${Math.floor(d)}s`;const P=Math.floor(d/60);if(P<60)return`${P}m`;const te=Math.floor(P/60),le=P%60;return le?`${te}h ${le}m`:`${te}h`}function xe(k){return k?k.oauthProvider?`${k.sessionPreview} (${k.oauthProvider})`:k.sessionPreview||"--":"--"}function _e(){_.value=null,o.value="",u.value=!1}function be(){j.value&&(j.value.abort(),j.value=null)}async function ye(){if(!s.apiKeyValue){_e();return}be();const k=new AbortController;j.value=k,u.value=!0,o.value="";try{const d=await fetch(`${Ae}/apiStats/api-key/sticky-diagnostics`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:s.apiKeyValue,provider:f.value}),signal:k.signal});if(!d.ok){const te=await d.json().catch(()=>({}));throw new Error(te.message||te.error||`HTTP ${d.status}`)}const P=await d.json();if(!(P!=null&&P.success))throw new Error((P==null?void 0:P.message)||"Failed to fetch sticky diagnostics");_.value=P.data||null}catch(d){if(d.name==="AbortError")return;_.value=null,o.value=d.message||"Failed to fetch sticky diagnostics"}finally{j.value===k&&(j.value=null),u.value=!1}}async function Le(){if(!s.apiKeyValue)return;g.value="testing",O.value="",p.value="",A.value=0,F.value=Date.now(),C.value&&C.value.abort(),C.value=new AbortController;const k=`${Ae}/apiStats/api-key/test`;try{const d=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:s.apiKeyValue,provider:f.value,model:S.value}),signal:C.value.signal});if(!d.ok){const Y=await d.json().catch(()=>({}));throw new Error(Y.message||Y.error||`HTTP ${d.status}`)}const P=d.body.getReader(),te=new TextDecoder;let le=!1;for(;!le;){const{done:Y,value:Me}=await P.read();if(Y){le=!0;continue}const Ie=te.decode(Me).split(`
`);for(const we of Ie)if(we.startsWith("data: "))try{const De=JSON.parse(we.substring(6));Pe(De)}catch{}}}catch(d){if(d.name==="AbortError")return;g.value="error",p.value=d.message||"Connection failed",A.value=Date.now()-F.value}}ve(f,k=>{const d=c[k]||c.claude;d.models.includes(S.value)||(S.value=d.defaultModel),s.show&&s.apiKeyValue&&ye()},{immediate:!0});function Pe(k){switch(k.type){case"test_start":break;case"content":O.value+=k.text;break;case"message_stop":break;case"test_complete":A.value=Date.now()-F.value,k.success?g.value="success":(g.value="error",p.value=k.error||"Test failed"),ye();break;case"error":g.value="error",p.value=k.error||"Unknown error",A.value=Date.now()-F.value;break}}function he(){g.value!=="testing"&&(C.value&&(C.value.abort(),C.value=null),be(),g.value="idle",O.value="",p.value="",A.value=0,_e(),v("close"))}return ve(()=>s.show,k=>{if(k){g.value="idle",O.value="",p.value="",A.value=0,oe(),ye();return}be()}),ve(()=>s.apiKeyProfile,()=>{!s.show||g.value==="testing"||(oe(),ye())}),Ke(()=>{C.value&&C.value.abort(),be()}),(k,d)=>(r(),pe(Oe,{to:"body"},[z.show?(r(),l("div",xl,[e("div",{class:"absolute inset-0",onClick:he}),e("div",yl,[e("div",pl,[e("div",vl,[e("div",{class:U(["flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl text-white shadow-lg",g.value==="success"?"bg-gradient-to-br from-green-500 to-emerald-500":g.value==="error"?"bg-gradient-to-br from-red-500 to-pink-500":"bg-gradient-to-br from-blue-500 to-indigo-500"])},[e("i",{class:U(["fas",g.value==="idle"?"fa-vial":g.value==="testing"?"fa-spinner fa-spin":g.value==="success"?"fa-check":"fa-times"])},null,2)],2),e("div",null,[d[2]||(d[2]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," API Key 端点测试 ",-1)),e("p",bl,a(E.value),1)])]),e("button",{class:"flex h-9 w-9 items-center justify-center rounded-full bg-gray-100 text-gray-500 transition hover:bg-gray-200 hover:text-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-200",disabled:g.value==="testing",onClick:he},d[3]||(d[3]=[e("i",{class:"fas fa-times text-sm"},null,-1)]),8,kl)]),e("div",hl,[e("div",_l,[d[5]||(d[5]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," API Key ",-1)),e("div",wl,[e("input",{class:"w-full rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 pr-10 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",readonly:"",type:"text",value:R.value},null,8,$l),d[4]||(d[4]=e("div",{class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400"},[e("i",{class:"fas fa-lock text-xs"})],-1))]),d[6]||(d[6]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 测试将使用此 API Key 调用当前服务的 /api 端点 ",-1))]),e("div",Cl,[e("div",null,[d[7]||(d[7]=e("label",{class:"mb-1 block text-xs font-medium text-gray-500 dark:text-gray-400"}," 测试平台 ",-1)),ge(e("select",{"onUpdate:modelValue":d[0]||(d[0]=P=>f.value=P),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",disabled:g.value==="testing"},[(r(!0),l(G,null,Z(Q.value,P=>(r(),l("option",{key:P.value,value:P.value},a(P.label),9,Tl))),128))],8,Sl),[[Se,f.value]]),e("p",Al," Default: "+a(H.value)+" (inferred from bound accounts) ",1)]),e("div",null,[d[8]||(d[8]=e("label",{class:"mb-1 block text-xs font-medium text-gray-500 dark:text-gray-400"}," 测试模型 ",-1)),ge(e("select",{"onUpdate:modelValue":d[1]||(d[1]=P=>S.value=P),class:"w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",disabled:g.value==="testing"},[(r(!0),l(G,null,Z(ie.value,P=>(r(),l("option",{key:P,value:P},a(P),9,Ll))),128))],8,Kl),[[Se,S.value]])])]),e("div",Pl,[e("div",Ml,[d[10]||(d[10]=e("span",{class:"text-gray-500 dark:text-gray-400"},"测试端点",-1)),e("span",Il,[d[9]||(d[9]=e("i",{class:"fas fa-link"},null,-1)),w(" "+a(B.value),1)])]),e("div",Dl,[d[11]||(d[11]=e("span",{class:"text-gray-500 dark:text-gray-400"},"测试模型",-1)),e("span",jl,a(S.value),1)]),e("div",Rl,[d[12]||(d[12]=e("span",{class:"text-gray-500 dark:text-gray-400"},"模拟客户端",-1)),e("span",Ol,a(K.value),1)])]),e("div",ql,[e("div",Ul,[d[14]||(d[14]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-heartbeat text-sm text-indigo-500 dark:text-indigo-300"}),e("span",{class:"text-xs font-semibold text-indigo-700 dark:text-indigo-200"},"Sticky Diagnostics")],-1)),e("button",{class:"rounded-md border border-indigo-200 bg-white px-2 py-1 text-xs text-indigo-600 transition hover:bg-indigo-50 disabled:cursor-not-allowed disabled:opacity-60 dark:border-indigo-500/40 dark:bg-indigo-900/40 dark:text-indigo-200 dark:hover:bg-indigo-900/60",disabled:u.value,onClick:ye},[e("i",{class:U(["fas",u.value?"fa-spinner fa-spin":"fa-rotate-right"])},null,2),d[13]||(d[13]=e("span",{class:"ml-1"},"Refresh",-1))],8,El)]),u.value?(r(),l("div",Nl,d[15]||(d[15]=[e("i",{class:"fas fa-circle-notch fa-spin"},null,-1),e("span",null,"Loading diagnostics...",-1)]))):o.value?(r(),l("div",Fl,a(o.value),1)):_.value?(r(),l("div",Vl,[e("div",Wl,[e("div",Bl,[d[16]||(d[16]=e("span",null,"Auto Renewal",-1)),e("span",zl,a(ee.value),1)]),e("div",Jl,[d[17]||(d[17]=e("span",null,"Full TTL",-1)),e("span",Gl,a(n.value),1)]),e("div",Hl,[d[18]||(d[18]=e("span",null,"Renew Threshold",-1)),e("span",Yl,a(i.value)+" ("+a(de.value)+") ",1)]),e("div",Ql,[d[19]||(d[19]=e("span",null,"Active Sessions",-1)),e("span",Xl,a(_.value.activeSessionCount),1)])]),_.value.note?(r(),l("p",Zl,a(_.value.note),1)):I("",!0),re.value.length>0?(r(),l("div",ei,[(r(!0),l(G,null,Z(re.value,P=>(r(),l("div",{key:`${P.provider}:${P.sessionHash}:${P.accountId}`,class:"grid grid-cols-[1fr_auto] gap-2 text-[11px] text-gray-600 dark:text-gray-300"},[e("div",{class:"truncate",title:xe(P)},[e("span",si,a(P.accountType)+" / "+a(P.accountId),1),e("span",ai,a(xe(P)),1)],8,ti),e("span",ri,a(fe(P.ttlSeconds)),1)]))),128))])):I("",!0)])):(r(),l("div",li,"No diagnostics data"))]),e("div",{class:U(["mb-4 rounded-xl border p-4 transition-all duration-300",W.value])},[e("div",ii,[e("div",{class:U(["flex h-8 w-8 items-center justify-center rounded-lg",m.value])},[e("i",{class:U(["fas text-sm",T.value,q.value])},null,2)],2),e("div",null,[e("p",{class:U(["font-medium",J.value])},a(b.value),3),e("p",oi,a(D.value),1)])])],2),g.value!=="idle"?(r(),l("div",ni,[e("div",di,[d[20]||(d[20]=e("span",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"},"AI 响应",-1)),O.value?(r(),l("span",ui,a(O.value.length)+" 字符 ",1)):I("",!0)]),e("div",ci,[O.value?(r(),l("p",mi,[w(a(O.value)+" ",1),g.value==="testing"?(r(),l("span",gi)):I("",!0)])):g.value==="testing"?(r(),l("p",fi,d[21]||(d[21]=[e("i",{class:"fas fa-circle-notch fa-spin"},null,-1),w(" 等待响应中... ",-1)]))):g.value==="error"&&p.value?(r(),l("p",xi,a(p.value),1)):I("",!0)])])):I("",!0),A.value>0?(r(),l("div",yi,[d[22]||(d[22]=e("i",{class:"fas fa-clock"},null,-1)),e("span",null,"耗时 "+a((A.value/1e3).toFixed(2))+" 秒",1)])):I("",!0)]),e("div",pi,[e("button",{class:"rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition hover:bg-gray-50 hover:shadow dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",disabled:g.value==="testing",onClick:he}," 关闭 ",8,vi),e("button",{class:U(["flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium shadow-sm transition",g.value==="testing"||!z.apiKeyValue?"cursor-not-allowed bg-gray-200 text-gray-400 dark:bg-gray-700 dark:text-gray-500":"bg-gradient-to-r from-blue-500 to-indigo-500 text-white hover:from-blue-600 hover:to-indigo-600 hover:shadow-md"]),disabled:g.value==="testing"||!z.apiKeyValue,onClick:Le},[e("i",{class:U(["fas",g.value==="testing"?"fa-spinner fa-spin":"fa-play"])},null,2),w(" "+a(g.value==="testing"?"测试中...":g.value==="idle"?"开始测试":"重新测试"),1)],10,bi)])])])):I("",!0)]))}},hi={class:"glass-strong mb-6 rounded-3xl p-4 shadow-xl md:mb-8 md:p-6"},_i={class:"flex flex-col items-center justify-between gap-4 md:flex-row"},wi={class:"flex items-center gap-2 md:gap-4"},$i={class:"flex items-center"},Ci={key:0,class:"h-8 w-px bg-gradient-to-b from-transparent via-gray-300 to-transparent opacity-50 dark:via-gray-600"},Si={class:"mb-6 md:mb-8"},Ti={class:"flex justify-center"},Ai={class:"inline-flex w-full max-w-lg rounded-full border border-white/20 bg-white/10 p-1 shadow-lg backdrop-blur-xl md:w-auto"},Ki={key:0,class:"tab-content"},Li={key:0,class:"mb-6 md:mb-8"},Pi={class:"rounded-xl border border-red-500/30 bg-red-500/20 p-3 text-sm text-red-800 backdrop-blur-sm dark:border-red-500/20 dark:bg-red-500/10 dark:text-red-200 md:p-4 md:text-base"},Mi={key:1,class:"fade-in"},Ii={class:"glass-strong rounded-3xl p-4 shadow-xl md:p-6"},Di={class:"mb-4 border-b border-gray-200 pb-4 dark:border-gray-700 md:mb-6 md:pb-6"},ji={class:"flex flex-col items-start justify-between gap-3 md:flex-row md:items-center md:gap-4"},Ri={class:"flex w-full items-center gap-2 md:w-auto"},Oi=["disabled"],qi=["disabled"],Ui=["disabled"],Ei={class:"mb-6 mt-6 grid grid-cols-1 gap-4 md:mb-8 md:mt-8 md:gap-6 xl:grid-cols-2 xl:items-stretch"},Ni={key:1,class:"tab-content"},Fi={class:"glass-strong rounded-3xl shadow-xl"},Vi={key:2,class:"tab-content"},Wi={__name:"ApiStatsView",setup(z){const h=Ue(),s=ce(),v=Ne(),c=M("stats"),x=L(()=>v.isDarkMode),{apiKey:y,apiId:$,loading:g,modelStatsLoading:O,oemLoading:p,error:A,statsPeriod:F,statsData:C,oemSettings:_,multiKeyMode:u}=ue(s),{queryStats:o,switchPeriod:j,loadStatsWithApiId:f,loadOemSettings:S,reset:E}=s,R=M(!1),V=()=>{R.value=!0},Q=()=>{R.value=!1},ie=B=>{(B.ctrlKey||B.metaKey)&&B.key==="Enter"&&(!g.value&&y.value.trim()&&o(),B.preventDefault()),B.key==="Escape"&&E()};return qe(()=>{v.initTheme(),S();const B=h.query.apiId,K=h.query.apiKey;B&&B.match(/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i)?($.value=B,f()):K&&K.length>10&&(y.value=K),document.addEventListener("keydown",ie)}),Ke(()=>{document.removeEventListener("keydown",ie)}),ve(y,B=>{B||s.clearData()}),(B,K)=>{var re;const X=Ee("router-link");return r(),l("div",{class:U(["min-h-screen p-4 md:p-6",x.value?"gradient-bg-dark":"gradient-bg"])},[e("div",hi,[e("div",_i,[se(Fe,{loading:t(p),"logo-src":t(_).siteIconData||t(_).siteIcon,subtitle:c.value==="stats"?"API Key 使用统计":c.value==="merge"?"密钥融合":"使用教程",title:t(_).siteName},null,8,["loading","logo-src","subtitle","title"]),e("div",wi,[e("div",$i,[se(Ve,{mode:"dropdown"})]),t(_).ldapEnabled||t(_).showAdminButton!==!1?(r(),l("div",Ci)):I("",!0),t(_).ldapEnabled?(r(),pe(X,{key:1,class:"user-login-button flex items-center gap-2 rounded-2xl px-4 py-2 text-white transition-all duration-300 md:px-5 md:py-2.5",to:"/user-login"},{default:Te(()=>K[5]||(K[5]=[e("i",{class:"fas fa-user text-sm md:text-base"},null,-1),e("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"用户登录",-1)])),_:1,__:[5]})):I("",!0),t(_).showAdminButton!==!1?(r(),pe(X,{key:2,class:"admin-button-refined flex items-center gap-2 rounded-2xl px-4 py-2 transition-all duration-300 md:px-5 md:py-2.5",to:"/dashboard"},{default:Te(()=>K[6]||(K[6]=[e("i",{class:"fas fa-shield-alt text-sm md:text-base"},null,-1),e("span",{class:"text-xs font-semibold tracking-wide md:text-sm"},"管理后台",-1)])),_:1,__:[6]})):I("",!0)])])]),e("div",Si,[e("div",Ti,[e("div",Ai,[e("button",{class:U(["tab-pill-button",c.value==="stats"?"active":""]),onClick:K[0]||(K[0]=ee=>c.value="stats")},K[7]||(K[7]=[e("i",{class:"fas fa-chart-line mr-1 md:mr-2"},null,-1),e("span",{class:"text-sm md:text-base"},"统计查询",-1)]),2),e("button",{class:U(["tab-pill-button",c.value==="merge"?"active":""]),onClick:K[1]||(K[1]=ee=>c.value="merge")},K[8]||(K[8]=[e("i",{class:"fas fa-link mr-1 md:mr-2"},null,-1),e("span",{class:"text-sm md:text-base"},"密钥融合",-1)]),2),e("button",{class:U(["tab-pill-button",c.value==="tutorial"?"active":""]),onClick:K[2]||(K[2]=ee=>c.value="tutorial")},K[9]||(K[9]=[e("i",{class:"fas fa-graduation-cap mr-1 md:mr-2"},null,-1),e("span",{class:"text-sm md:text-base"},"使用教程",-1)]),2)])])]),c.value==="stats"?(r(),l("div",Ki,[se(gt),t(A)?(r(),l("div",Li,[e("div",Pi,[K[10]||(K[10]=e("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1)),w(" "+a(t(A)),1)])])):I("",!0),t(C)?(r(),l("div",Mi,[e("div",Ii,[e("div",Di,[e("div",ji,[K[14]||(K[14]=e("div",{class:"flex items-center gap-2 md:gap-3"},[e("i",{class:"fas fa-clock text-base text-blue-500 md:text-lg"}),e("span",{class:"text-base font-medium text-gray-700 dark:text-gray-200 md:text-lg"},"统计时间范围")],-1)),e("div",Ri,[e("button",{class:U(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:t(F)==="daily"}]]),disabled:t(g)||t(O),onClick:K[3]||(K[3]=ee=>t(j)("daily"))},K[11]||(K[11]=[e("i",{class:"fas fa-calendar-day text-xs md:text-sm"},null,-1),w(" 今日 ",-1)]),10,Oi),e("button",{class:U(["flex flex-1 items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:flex-none md:gap-2 md:px-6 md:text-sm",["period-btn",{active:t(F)==="monthly"}]]),disabled:t(g)||t(O),onClick:K[4]||(K[4]=ee=>t(j)("monthly"))},K[12]||(K[12]=[e("i",{class:"fas fa-calendar-alt text-xs md:text-sm"},null,-1),w(" 本月 ",-1)]),10,qi),t(u)?I("",!0):(r(),l("button",{key:0,class:"test-btn flex items-center justify-center gap-1 px-4 py-2 text-xs font-medium md:gap-2 md:px-6 md:text-sm",disabled:t(g),onClick:V},K[13]||(K[13]=[e("i",{class:"fas fa-vial text-xs md:text-sm"},null,-1),w(" 测试 ",-1)]),8,Ui))])])]),se(Ms),e("div",Ei,[se(Ys,{class:"h-full"}),t(u)?(r(),pe(_r,{key:0,class:"h-full"})):(r(),pe(or,{key:1,class:"h-full"}))]),se(Jr)])])):I("",!0)])):I("",!0),c.value==="tutorial"?(r(),l("div",Ni,[e("div",Fi,[se(ze)])])):I("",!0),c.value==="merge"?(r(),l("div",Vi,[se(fl)])):I("",!0),se(ki,{"api-key-name":((re=t(C))==null?void 0:re.name)||"","api-key-profile":t(C),"api-key-value":t(y),show:R.value,onClose:Q},null,8,["api-key-name","api-key-profile","api-key-value","show"])],2)}}},eo=ne(Wi,[["__scopeId","data-v-95696d82"]]);export{eo as default};
